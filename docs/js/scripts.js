const CLOCK=document.querySelector("#clock");let clockStats={width:CLOCK.clientWidth,height:CLOCK.clientHeight};const DOTS_CONTAINER=document.querySelector("#dotsContainer"),LINE_CONTAINER=document.querySelector("#lineContainer"),LINE=document.querySelector("#line"),CIRCLE_CONTAINER=document.querySelector("#circleContainer"),CIRCLE=document.querySelector("#circleContainer .circle"),FILL_CIRCLE=document.querySelector("#circleContainer .fill-circle"),clockContainer=document.querySelector("#clock_container"),timersContainer=document.querySelector("#timers_container");let OPTIONS={},CLOCK_INTERVAL=setInterval(showClockTime,1e3),TIMER_INTERVALS={},storedTimers=localStorage.getItem("timers")?JSON.parse(localStorage.getItem("timers")):null;function addDots(){for(var e=window.innerWidth<640?clockStats.width/2.5:clockStats.width/3,t=(clockStats.width,0),s=2*Math.PI/60,a=1;a<=60;a++){let r=document.createElement("i");r.classList.add("dot",`dot-${a}`,"far","fa-circle","text-xxs","md:text-xs","m-0.5","text-accent-500","absolute"),r.setAttribute("idx",a);var l=window.innerWidth<640?8:12,c=l,i=Math.round(2*e*Math.cos(t)-l/2),o=Math.round(2*e*Math.sin(t)-c/2);r.style.top=`${o}px`,r.style.left=`${i}px`,t+=s,DOTS_CONTAINER.appendChild(r)}}function setCircle(){var e=1.45*clockStats.width,t=e/2,s=e/2-16>0?e/2-16:30,a=.05*e;CIRCLE_CONTAINER.style.width=`${e+50}px`,CIRCLE_CONTAINER.style.height=`${e+50}px`,document.querySelectorAll(".circle").forEach((e=>{e.setAttribute("cy",t),e.setAttribute("cx",t),e.setAttribute("r",s),e.style.strokeWidth=a})),FILL_CIRCLE.style.strokeDasharray=3*e,FILL_CIRCLE.style.strokeDashoffset=3*e,updateCircle()}function updateCircle(e=null){if(null===e){e=(new Date).getSeconds()}var t=1.45*clockStats.width*3;FILL_CIRCLE.style.strokeDashoffset=t-t*(e/60)}function localTimers(e){let t;return"get"===e&&(t=void 0!==localStorage.getItem("timers")?JSON.parse(localStorage.getItem("timers")):{message:"no timers found"}),"set"!==e&&"save"!==e||(localStorage.setItem("timers",JSON.stringify(TIMER_INTERVALS)),t={message:"complete"}),"clear"===e&&(localStorage.removeItem("timers"),t={message:"timers removed"}),t}function updateOptions(){let e=void 0!==localStorage.getItem("timer_options")?JSON.parse(localStorage.getItem("timer_options")):null;const t={show_seconds:document.querySelector("[name='show_seconds']").checked,sec_numbers:document.querySelector("[name='sec_numbers']").checked,seconds_display:document.querySelector("[name='seconds_display']").value,hr24:document.querySelector("[name='hr24']").checked,clock_right:document.querySelector("[name='clock_right']").checked};OPTIONS=void 0===OPTIONS.show_seconds&&null!==e?e:t,localStorage.setItem("timer_options",JSON.stringify(OPTIONS)),Object.keys(OPTIONS).forEach((e=>{"seconds_display"!==e&&(OPTIONS[e]?document.querySelector(`[name="${e}"]`).setAttribute("checked",!0):document.querySelector(`[name="${e}"]`).removeAttribute("checked"))})),updateLayout(),updateClockDisplay()}function updateLayout(){OPTIONS.clock_right?(clockContainer.classList.remove("place-top","md:place-left"),clockContainer.classList.add("place-bottom","md:place-right"),timersContainer.classList.remove("place-bottom","md:place-right"),timersContainer.classList.add("place-top","md:place-left")):(clockContainer.classList.remove("place-bottom","md:place-right"),clockContainer.classList.add("place-top","md:place-left"),timersContainer.classList.remove("place-top","md:place-left"),timersContainer.classList.add("place-bottom","md:place-right"))}function updateClockDisplay(){if(document.querySelector("#seconds_display").classList.add("hidden"),DOTS_CONTAINER.classList.add("hidden"),LINE_CONTAINER.classList.add("hidden"),CIRCLE_CONTAINER.classList.add("hidden"),OPTIONS.show_seconds){document.querySelector("#seconds_display").classList.remove("hidden");const e=OPTIONS.seconds_display;"dots"===e?(DOTS_CONTAINER.classList.remove("hidden"),LINE_CONTAINER.classList.add("hidden"),CIRCLE_CONTAINER.classList.add("hidden")):"line"===e?(LINE_CONTAINER.classList.remove("hidden"),DOTS_CONTAINER.classList.add("hidden"),CIRCLE_CONTAINER.classList.add("hidden")):"circle"===e?(LINE_CONTAINER.classList.add("hidden"),DOTS_CONTAINER.classList.add("hidden"),CIRCLE_CONTAINER.classList.remove("hidden"),updateCircle()):(DOTS_CONTAINER.classList.add("hidden"),LINE_CONTAINER.classList.add("hidden"),CIRCLE_CONTAINER.classList.add("hidden"))}}function updateTitle(e,t){TIMER_INTERVALS[e].title=t,localTimers("save")}function formatDateTime(e,t=!1,s=!1,a=!1){let l,c,i,o,r,n,u="",m="";return void 0!==e.h&&(l=e.h>=10?e.h:`0${e.h}`,c=e.m>=10?e.m:`0${e.m}`,i=e.s>=10?e.s:`0${e.s}`,u=`${l}:${c}:${i}`),s&&(d=new Date,e.y=d.getFullYear(),e.n=d.getMonth()+1,e.d=d.getDate()),void 0!==e.y&&(o=e.y,r=e.n>=10?e.n:`0${e.n}`,n=e.d>=10?e.d:`0${e.d}`,m=`${o}-${r}-${n}`),a?t?`${m} ${u}`:void 0!==e.h?u:void 0!==e.y?m:JSON.stringify(e):t?{hour:l,minute:c,second:i,year:o,month:r,date:n}:void 0!==e.h?{hour:l,minute:c,second:i}:void 0!==e.y?{year:o,month:r,date:n}:e}function showClockTime(){let e=new Date,t=e.getHours(),a=e.getMinutes(),l=e.getSeconds(),c=t>12?"PM":"AM";t>12&&!OPTIONS.hr24&&(t-=12),s=l<10?"0"+l:l;let i=`${t<10?"0"+t:t}:${a<10?"0"+a:a}`;if(OPTIONS.show_seconds&&OPTIONS.sec_numbers&&(i+=`:${s}`),OPTIONS.hr24||(i+=` ${c}`),OPTIONS.show_seconds&&"dots"===OPTIONS.seconds_display&&DOTS_CONTAINER.querySelectorAll(".dot").forEach((e=>{parseInt(e.getAttribute("idx"))<=l+1?(e.classList.remove("far"),e.classList.add("fas")):(e.classList.add("far"),e.classList.remove("fas"))})),OPTIONS.show_seconds&&"line"===OPTIONS.seconds_display){let e=l/59*100;LINE.style.width=`${e}%`}OPTIONS.show_seconds&&"circle"===OPTIONS.seconds_display&&updateCircle(l),CLOCK.innerText=i,CLOCK.stats={width:CLOCK.clientWidth,height:CLOCK.clientHEIGHT}}function showTimerTime(e,t){let s=TIMER_INTERVALS[t];s.s<59?s.s++:s.s>=59&&s.m<59?(s.s=0,s.m++):s.s>=59&&s.m>=59&&(s.s=0,s.m=0,s.h++);let a=formatDateTime(s);TIMER_INTERVALS[t]={...TIMER_INTERVALS[t],...s},localTimers("save"),e.innerText=`${a.hour}:${a.minute}:${a.second}`}updateOptions(),addDots(),setCircle(),updateLayout(),updateClockDisplay(),document.querySelectorAll("input.opt-input").forEach((e=>{e.addEventListener("click",(function(){updateOptions(),"clock_right"===e.name?updateLayout(e.value):(updateClockDisplay(),clearInterval(CLOCK_INTERVAL),CLOCK_INTERVAL=setInterval(showClockTime,1e3))}))})),document.querySelector("#seconds_display").addEventListener("change",(e=>{console.log("seconds display select changed",e.target.value),updateOptions(),updateClockDisplay()})),document.querySelectorAll(".timer").forEach((e=>{const t=e.querySelector(".play-pause > i"),s=e.querySelector("form"),a=localTimers("get");let l=e.querySelector(".clear-time"),c=parseInt(e.dataset.idx),i=e.querySelector(".time"),o=e.querySelector("[name='title']").value;TIMER_INTERVALS[c]={title:o,h:0,m:0,s:0,interval:null},null!==a&&!a.message&&a[c]?(TIMER_INTERVALS[c]={...a[c],interval:null},o=TIMER_INTERVALS[c].title):localTimers("save"),e.querySelector("[name='title']").value!==o&&(e.querySelector("[name='title']").value=o),(TIMER_INTERVALS[c].h>0||TIMER_INTERVALS[c].m>0||TIMER_INTERVALS[c].s>0)&&l.classList.remove("disabled");const r=formatDateTime(TIMER_INTERVALS[c],!1,!1,!0);i.innerText=r,t.addEventListener("click",(function(){"true"===t.dataset.playing?(t.dataset.playing="false",t.classList.add("fa-play-circle"),t.classList.remove("fa-pause-circle"),clearInterval(TIMER_INTERVALS[c].interval)):(t.dataset.playing="true",t.classList.remove("fa-play-circle"),t.classList.add("fa-pause-circle"),TIMER_INTERVALS[c].interval=setInterval((function(){showTimerTime(i,c,TIMER_INTERVALS[c])}),1e3),l.classList.remove("disabled"))})),l.addEventListener("click",(function(){l.classList.contains("disabled")||(clearInterval(TIMER_INTERVALS[c].interval),TIMER_INTERVALS[c]={...TIMER_INTERVALS[c],h:0,m:0,s:0,interval:null},i.innerText=formatDateTime(TIMER_INTERVALS[c],!1,!1,!0),localTimers("save"),l.classList.add("disabled"))})),s.addEventListener("submit",(function(e){e.preventDefault(),s.querySelector("input").blur(),updateTitle(c,e.target[0].value)})),s.querySelector("input").addEventListener("blur",(function(e){updateTitle(c,e.target.value)}))}));